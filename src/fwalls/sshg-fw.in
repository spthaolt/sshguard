#!/bin/sh
@sshg_fw_subr@

fw_log() {
    logger -p auth.info -t sshg-fw $1
}

fw_init || exit 1

while [ true ]; do
    read command address addrtype
    if [ "$command" == "block" ]; then
        fw_block $address $addrtype && fw_log "Blocked $address"
    elif [ "$command" == "release" ]; then
        fw_release $address $addrtype && fw_log "Released $address"
    elif [ "$command" == "flush" ]; then
        fw_flush && fw_log "Flushed blocked addresses"
    else
        break
    fi
done

fw_fin || exit 1
